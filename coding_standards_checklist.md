# C++编码规范与语法检查清单

## 🎯 使用说明

这个检查清单基于实际编码错误总结，旨在：
- **预防常见语法错误**
- **提高编码专注度** 
- **建立标准编码习惯**
- **减少调试时间**

**使用方法**：
1. 📌 **打印便携版**贴在显示器旁
2. ⚡ **实时检查**：每写5行代码过一遍
3. 🔍 **阶段检查**：每个函数完成后详细检查
4. 🎯 **最终检查**：提交前全面检查

---

## 📋 语法检查清单

### 🎯 指针访问语法 (新增 - 基于104题错误)
- [ ] **指针变量**：使用 `ptr->member` 访问成员
- [ ] **对象变量**：使用 `obj.member` 访问成员  
- [ ] **TreeNode指针**：`node->left`, `node->right`, `node->val`
- [ ] **避免混淆**：`TreeNode* node` 是指针，用 `->`

**记忆口诀**：指针箭头(`->`)，对象点号(`.`)

### 🔄 循环条件设计 (新增 - 基于104题错误)
- [ ] **固定边界**：避免在循环中使用动态变化的条件
- [ ] **BFS模式**：`int size = q.size(); for(int i=0; i<size; i++)`
- [ ] **避免陷阱**：不要用 `for(int i=0; i<q.size(); i++)` (size会变化)
- [ ] **预存条件**：将循环次数在循环前确定

**记忆口诀**：循环条件要固定，避免动态来变化

### 📦 容器初始化语法 (新增 - 基于104题错误)
- [ ] **栈声明**：`stack<datatype> st;` 然后 `st.push(value);`
- [ ] **避免错误**：不要用 `stack<type> st(value)` 这种语法
- [ ] **pair类型**：`stack<pair<TreeNode*, int>> st;`
- [ ] **标准流程**：声明 → 初始化 → 使用

**记忆口诀**：容器声明要标准，初始化分步骤

### ➕ 自增操作符理解 (新增 - 基于104题错误)
- [ ] **后置自增**：`value++` 先使用当前值，再自增
- [ ] **前置自增**：`++value` 先自增，再使用新值
- [ ] **副作用影响**：`depth++` 会改变原变量
- [ ] **表达式计算**：`depth + 1` 不改变原变量
- [ ] **场景选择**：传递值时用 `+ 1`，循环计数用 `++`

**记忆口诀**：传值用加号，原值不变化；计数用自增，变量会增加

### 🔤 变量命名规范 (更新)

### 🔴 一级检查：基础语法 (每行必查)

#### 1. 变量声明
```cpp
// ❌ 常见错误
int left = 0; right = size - 1;     // 混用分号和逗号
int i, j, k                         // 缺少分号
vector<int> dp(n,1)                 // 空格不规范
auto it=lower_bound(arr.begin(),arr.end(),target);  // 缺少空格

// ✅ 正确写法
int left = 0, right = size - 1;     // 同类型变量用逗号分隔
int i, j, k;                        // 语句结束加分号
vector<int> dp(n, 1);               // 逗号后加空格
auto it = lower_bound(arr.begin(), arr.end(), target);  // 规范空格
```

**检查点**：
- [ ] 同类型变量声明用逗号 `,` 分隔
- [ ] 语句结束用分号 `;` 
- [ ] 函数调用参数间有空格
- [ ] 变量名拼写正确
- [ ] 赋值操作符 `=` 两边有空格

#### 2. 条件判断
```cpp
// ❌ 常见错误
if memo[i] != -1 return memo[i];    // 缺少括号
if(condition)statement;             // 缺少空格和大括号
if (left<=right) {                 // 操作符缺少空格
if(nums[j]<nums[i]){               // 缺少空格

// ✅ 正确写法  
if (memo[i] != -1) return memo[i];  // 条件加括号
if (condition) {                    // 适当空格
    statement;                      // 大括号增强可读性
}
if (left <= right) {                // 操作符两边加空格
if (nums[j] < nums[i]) {           // 规范空格
```

**检查点**：
- [ ] 条件表达式用圆括号 `()` 包围
- [ ] `if` 和 `()` 之间有空格
- [ ] 比较操作符 `<=`, `>=`, `!=`, `==`, `<`, `>` 两边有空格
- [ ] 复杂条件使用大括号 `{}`
- [ ] 数组访问和比较操作格式规范

#### 3. 循环语句
```cpp
// ❌ 常见错误
for(int j=0;j<i;i++) {              // 递增变量错误
for(int i=1,i<n,i++) {              // 分隔符错误
while(left<=right){                 // 缺少空格
for(int i=1;i<n;i++){              // 缺少空格

// ✅ 正确写法
for(int j = 0; j < i; j++) {        // 正确的循环变量和空格
for(int i = 1; i < n; i++) {        // 分号分隔，规范空格
while(left <= right) {              // 适当空格
for (int coin : coins) {            // range-based for循环
```

**检查点**：
- [ ] `for` 循环三部分用分号 `;` 分隔
- [ ] 循环变量与循环目的一致 (j循环用j++，不是i++)
- [ ] 循环条件操作符两边有空格
- [ ] 循环体使用大括号
- [ ] range-based for循环语法正确

#### 4. 函数调用
```cpp
// ❌ 常见错误
max(dp[j]+1);                       // 缺少参数
helper(nums,i,memo);                // 缺少空格
max_element(dp.begin,dp.end);       // 缺少括号
lower_bound(tails.begin(),tails.end(),num);  // 缺少空格

// ✅ 正确写法
max(dp[i], dp[j] + 1);              // 正确参数数量和空格
helper(nums, i, memo);              // 参数间有空格
max_element(dp.begin(), dp.end());  // 正确的函数调用
lower_bound(tails.begin(), tails.end(), num);  // 规范空格
```

**检查点**：
- [ ] 函数参数数量正确
- [ ] 参数间用逗号和空格分隔
- [ ] 函数调用语法正确（括号、逗号）
- [ ] 成员函数调用有括号 `()`

---

### 🟡 二级检查：算法逻辑 (函数级别)

#### 1. DP状态转移
```cpp
// ❌ 常见错误
dp[i] = max(dp[j] + 1);             // 缺少当前值比较
dp[i] = max(dp[i], newValue)        // 缺少分号
dp[i] = min(dp[i-coin]+1);          // 缺少当前值比较

// ✅ 正确写法
dp[i] = max(dp[i], dp[j] + 1);      // 比较当前值和新值
dp[i] = min(dp[i], dp[i-coin] + 1); // 完全背包状态转移
```

**DP模板检查点**：
- [ ] 状态转移必须比较新旧值：`max(dp[i], newValue)` 或 `min(dp[i], newValue)`
- [ ] 状态转移方程与递推关系一致
- [ ] 边界条件正确初始化
- [ ] 最终答案计算正确（可能需要遍历所有状态）

#### 2. 二分查找
```cpp
// ❌ 常见错误
int mid = (left + right) / 2;       // 放在while外面
while(left <= right) {
    // 使用过时的mid值
}
int pos;                            // 未初始化

// ✅ 正确写法
int pos = arr.size();               // 初始化为"未找到"标志
while(left <= right) {
    int mid = left + (right - left) / 2;  // 每次重新计算
    if (arr[mid] >= target) {
        pos = mid;
        right = mid - 1;
    } else {
        left = mid + 1;
    }
}
```

**二分查找模板检查点**：
- [ ] `pos` 初始化为 `size()` 作为"未找到"标志
- [ ] `mid` 在while循环内重新计算
- [ ] 边界更新正确：`left = mid + 1` 或 `right = mid - 1`
- [ ] 避免整数溢出：用 `left + (right-left)/2`
- [ ] 循环条件使用 `<=`

#### 3. 记忆化搜索
```cpp
// ❌ 常见错误
memo[i] = calculate();              // 忘记返回
return calculate();                 // 忘记缓存
if memo[i] != -1 return memo[i];    // 缺少括号

// ✅ 正确写法
if (memo[i] != -1) return memo[i];  // 1. 检查缓存
memo[i] = calculate_result;         // 2. 计算并缓存  
return memo[i];                     // 3. 返回缓存值
```

**记忆化搜索模板检查点**：
- [ ] 四步骤完整：检查缓存→计算→存储缓存→返回
- [ ] 缓存初始化值合理（通常是-1）
- [ ] 递归终止条件正确
- [ ] 条件判断加括号

---

### 🟢 三级检查：边界和安全 (提交前)

#### 1. 数组访问安全
```cpp
// ❌ 潜在错误
nums[i-1]                           // i可能为0
dp[j+1]                             // j可能为size-1
tails[mid]                          // mid可能越界

// ✅ 安全写法
if (i > 0) nums[i-1]                // 边界检查
if (j < size-1) dp[j+1]             // 边界检查
if (mid < tails.size()) tails[mid]  // 边界检查
```

**边界安全检查点**：
- [ ] 数组下标不为负数
- [ ] 数组下标不超过 `size()-1`
- [ ] 使用 `empty()` 检查容器是否为空
- [ ] 循环边界使用 `<` 而不是 `<=` (除非特殊需要)

#### 2. 函数参数和返回值
```cpp
// ❌ 常见错误
helper(nums, memo, i);              // 参数顺序错误
int result = function();            // 类型不匹配
return 0;                           // 忘记返回正确值

// ✅ 正确写法
helper(nums, i, memo);              // 正确的参数顺序
auto result = function();           // 类型匹配
return maxResult;                   // 返回正确的计算结果
```

**函数检查点**：
- [ ] 函数参数顺序正确
- [ ] 返回值类型匹配
- [ ] 引用参数传递正确
- [ ] 函数名和功能一致

---

## 🚀 检查流程

### ⚡ 编码时的实时检查 (写每5行代码后)
```markdown
快速5秒检查：
1. 语法符号对吗？(括号、分号、逗号)
2. 变量名拼写对吗？
3. 空格格式规范吗？
```

### 🔍 函数完成后的检查 (2分钟)
```markdown
详细检查：
1. 🔴 变量声明语法 ✅
2. 🔴 循环条件和变量 ✅  
3. 🟡 算法逻辑正确性 ✅
4. 🟡 边界条件处理 ✅
```

### 🎯 提交前的最终检查 (5分钟)
```markdown
全面检查：
1. 🟢 编译能否通过 ✅
2. 🟢 测试用例能否通过 ✅
3. 🟢 边界情况是否安全 ✅
4. 🟢 代码风格是否一致 ✅
```

---

## 📱 便携版检查卡片

```
🔴 基础语法 (必查)
□ 变量声明: 逗号分隔，分号结尾，空格规范
□ 条件判断: 括号包围，操作符两边空格  
□ 循环语句: 变量对应，分号分隔，空格规范
□ 函数调用: 参数正确，空格规范

🟡 算法逻辑 (重点)
□ DP转移: 比较新旧值 max(dp[i], newValue)
□ 二分查找: pos初始化，mid循环内计算
□ 记忆化: 检查→计算→缓存→返回

🟢 边界安全 (提交前)
□ 数组访问: 下标边界检查
□ 函数调用: 参数顺序和类型正确
□ 返回值: 类型匹配，逻辑正确
```

---

## 🛠️ 工具辅助

### IDE设置建议
```cpp
// 启用这些功能：
- 语法高亮 ✅
- 自动补全 ✅  
- 括号匹配 ✅
- 错误下划线 ✅
- 实时编译检查 ✅
- 代码格式化 ✅
```

### 编译检查
```bash
# 启用更多警告
g++ -std=c++11 -Wall -Wextra -o program file.cpp

# 常用编译检查
g++ -std=c++11 -Wall -o program file.cpp
```

---

## 📊 错误预防效果

使用这个检查清单后，预期效果：
- **语法错误减少80%**
- **编译一次通过率提升到90%**
- **调试时间减少50%**
- **代码可读性显著提升**

---

## 🔄 持续改进

### 每周回顾
- 统计这周犯的错误类型
- 更新检查清单
- 加强薄弱环节练习

### 个人定制
- 根据个人错误模式调整重点
- 添加个人常犯错误到清单
- 建立个人编码风格标准

---

*创建日期: 2025-08-07*
*基于300题错误总结*
*持续更新中...*