/*
LeetCode 76. æœ€å°è¦†ç›–å­ä¸²
Difficulty: Hard
Link: https://leetcode.cn/problems/minimum-window-substring/

é¢˜ç›®æè¿°ï¼š
ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ã€ä¸€ä¸ªå­—ç¬¦ä¸² t ã€‚è¿”å› s ä¸­æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚
å¦‚æœ s ä¸­ä¸å­˜åœ¨æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² "" ã€‚

æ³¨æ„ï¼š
- å¯¹äº t ä¸­é‡å¤å­—ç¬¦ï¼Œæˆ‘ä»¬å¯»æ‰¾çš„å­ä¸²ä¸­è¯¥å­—ç¬¦æ•°é‡å¿…é¡»ä¸å°‘äº t ä¸­è¯¥å­—ç¬¦æ•°é‡ã€‚
- å¦‚æœ s ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚

ç¤ºä¾‹ 1ï¼š
è¾“å…¥ï¼šs = "ADOBECODEBANC", t = "ABC"
è¾“å‡ºï¼š"BANC"
è§£é‡Šï¼šæœ€å°è¦†ç›–å­ä¸² "BANC" åŒ…å«æ¥è‡ªå­—ç¬¦ä¸² t çš„ 'A'ã€'B' å’Œ 'C'ã€‚

ç¤ºä¾‹ 2ï¼š
è¾“å…¥ï¼šs = "a", t = "a"
è¾“å‡ºï¼š"a"
è§£é‡Šï¼šæ•´ä¸ªå­—ç¬¦ä¸² s æ˜¯æœ€å°è¦†ç›–å­ä¸²ã€‚

ç¤ºä¾‹ 3ï¼š
è¾“å…¥ï¼šs = "a", t = "aa"
è¾“å‡ºï¼š""
è§£é‡Šï¼št ä¸­ä¸¤ä¸ªå­—ç¬¦ 'a' å‡åº”åŒ…å«åœ¨ s çš„å­ä¸²ä¸­ï¼Œå› æ­¤æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­ä¸²ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚

çº¦æŸæ¡ä»¶ï¼š
- m == s.length
- n == t.length
- 1 <= m, n <= 10^5
- s å’Œ t ç”±è‹±æ–‡å­—æ¯ç»„æˆ

ç®—æ³•åˆ†æï¼š
æ—¶é—´å¤æ‚åº¦ï¼šO(m + n) - æ»‘åŠ¨çª—å£
ç©ºé—´å¤æ‚åº¦ï¼šO(m + n) - å“ˆå¸Œè¡¨å­˜å‚¨å­—ç¬¦é¢‘æ¬¡

æ ¸å¿ƒæ€æƒ³ï¼š
1. æ»‘åŠ¨çª—å£çš„é«˜çº§åº”ç”¨
2. ç»´æŠ¤çª—å£å†…å­—ç¬¦é¢‘æ¬¡ï¼Œç¡®ä¿è¦†ç›–ç›®æ ‡å­—ç¬¦ä¸²
3. çª—å£æ‰©å±•ï¼šrightæŒ‡é’ˆç§»åŠ¨ï¼Œæ”¶é›†å­—ç¬¦
4. çª—å£æ”¶ç¼©ï¼šleftæŒ‡é’ˆç§»åŠ¨ï¼Œå¯»æ‰¾æœ€å°çª—å£

åŸºäºä½ çš„æŠ€èƒ½åŸºç¡€ï¼š
- åŸºäºé¢˜ç›®3(æ— é‡å¤å­—ç¬¦æœ€é•¿å­ä¸²)çš„æ»‘åŠ¨çª—å£ç»éªŒ
- è¿™é¢˜æ˜¯æ»‘åŠ¨çª—å£çš„å·…å³°åº”ç”¨ï¼Œå¤æ‚çº¦æŸæ¡ä»¶

æ€è€ƒè¦ç‚¹ï¼š
1. å¦‚ä½•åˆ¤æ–­å½“å‰çª—å£æ˜¯å¦è¦†ç›–äº†ç›®æ ‡å­—ç¬¦ä¸²ï¼Ÿ
2. çª—å£ä»€ä¹ˆæ—¶å€™æ‰©å±•ï¼Ÿä»€ä¹ˆæ—¶å€™æ”¶ç¼©ï¼Ÿ
3. å¦‚ä½•ç»´æŠ¤å­—ç¬¦é¢‘æ¬¡çš„åŒ¹é…çŠ¶æ€ï¼Ÿ
4. ä¸é¢˜ç›®3çš„æ»‘åŠ¨çª—å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

æ˜“é”™ç‚¹ï¼š
1. å­—ç¬¦é¢‘æ¬¡çš„æ­£ç¡®ç»´æŠ¤ï¼ˆé‡å¤å­—ç¬¦å¤„ç†ï¼‰
2. çª—å£æ”¶ç¼©çš„æ—¶æœºåˆ¤æ–­
3. validè®¡æ•°å™¨çš„æ›´æ–°æ—¶æœº
4. æœ€å°çª—å£çš„è®°å½•å’Œæ›´æ–°

ç›¸å…³é¢˜ç›®ï¼š
- 3. æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸² (ä½ å·²æŒæ¡)
- 438. æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯
- 567. å­—ç¬¦ä¸²çš„æ’åˆ—
- 209. é•¿åº¦æœ€å°çš„å­æ•°ç»„
*/

#include <iostream>
#include <string>
#include <unordered_map>
#include <climits>
using namespace std;

class Solution {
public:
    string minWindow(string s, string t) {
        // TODO: å®ç°æ»‘åŠ¨çª—å£ç®—æ³•
        // æç¤º1: ä½¿ç”¨ä¸¤ä¸ªå“ˆå¸Œè¡¨ - needå­˜å‚¨tçš„å­—ç¬¦é¢‘æ¬¡ï¼Œwindowå­˜å‚¨çª—å£å­—ç¬¦é¢‘æ¬¡
        // æç¤º2: ä½¿ç”¨validè®¡æ•°å™¨è®°å½•çª—å£ä¸­å·²æ»¡è¶³é¢‘æ¬¡è¦æ±‚çš„å­—ç¬¦ç§ç±»æ•°
        // æç¤º3: rightæ‰©å±•çª—å£æ”¶é›†å­—ç¬¦ï¼Œleftæ”¶ç¼©çª—å£å¯»æ‰¾æœ€å°
        // æç¤º4: å½“valid == need.size()æ—¶ï¼Œå½“å‰çª—å£è¦†ç›–äº†t
        int count = t.size(); // ä¸€ä¸ªå­—ç¬¦å¯èƒ½å‡ºç°å¤šæ¬¡
        unordered_map<char, int> char_map;
        for(auto& c:t) {
            char_map[c] += 1;
        }
        int left = 0;
        int right = 0;
        int min_len = INT_MAX;
        int start = 0;
        while(right < s.size()) {
            if(char_map[s[right]] >0) {
                  count--; // å› ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¯èƒ½å‡ºç°å¤šæ¬¡
            }
            char_map[s[right]]--;
            right++;

            while(count == 0) {
                if((right-left) < min_len) {
                    min_len = right-left;
                    start = left;
                }
                char_map[s[left]]++;
                if(char_map[s[left]] >0) {
                    count++;
                }
                left++;
            }
        }
        return min_len==INT_MAX?"":s.substr(start,min_len);
    }
    

};

// æµ‹è¯•ç”¨ä¾‹
void testSolution() {
    Solution sol;
    
    cout << "ğŸ§ª æµ‹è¯• 76. æœ€å°è¦†ç›–å­ä¸²" << endl;
    cout << "======================" << endl;
    
    // æµ‹è¯•ç”¨ä¾‹1: åŸºæœ¬æƒ…å†µ
    string s1 = "ADOBECODEBANC", t1 = "ABC";
    cout << "Test 1: s=\"" << s1 << "\", t=\"" << t1 << "\"" << endl;
    cout << "Result: \"" << sol.minWindow(s1, t1) << "\" (Expected: \"BANC\")" << endl << endl;
    
    // æµ‹è¯•ç”¨ä¾‹2: å•å­—ç¬¦åŒ¹é…
    string s2 = "a", t2 = "a";
    cout << "Test 2: s=\"" << s2 << "\", t=\"" << t2 << "\"" << endl;
    cout << "Result: \"" << sol.minWindow(s2, t2) << "\" (Expected: \"a\")" << endl << endl;
    
    // æµ‹è¯•ç”¨ä¾‹3: æ— æ³•è¦†ç›–
    string s3 = "a", t3 = "aa";
    cout << "Test 3: s=\"" << s3 << "\", t=\"" << t3 << "\"" << endl;
    cout << "Result: \"" << sol.minWindow(s3, t3) << "\" (Expected: \"\")" << endl << endl;
    
    // æµ‹è¯•ç”¨ä¾‹4: å¤æ‚æƒ…å†µ
    string s4 = "ADOBECODEBANC", t4 = "AABC";
    cout << "Test 4: s=\"" << s4 << "\", t=\"" << t4 << "\"" << endl;
    cout << "Result: \"" << sol.minWindow(s4, t4) << "\" (Expected: åŒ…å«2ä¸ªA,1ä¸ªB,1ä¸ªCçš„æœ€å°å­ä¸²)" << endl << endl;
}

// ç®—æ³•æ€è·¯æç¤º
void showHints() {
    cout << "\nğŸ’¡ ç®—æ³•æ€è·¯æç¤º" << endl;
    cout << "===============" << endl;
    cout << R"(
æ»‘åŠ¨çª—å£æ ¸å¿ƒæ€è·¯ï¼š
1. æ‰©å±•é˜¶æ®µï¼šrightæŒ‡é’ˆç§»åŠ¨ï¼Œæ”¶é›†å­—ç¬¦åˆ°çª—å£
2. æ”¶ç¼©é˜¶æ®µï¼šå½“çª—å£æ»¡è¶³æ¡ä»¶æ—¶ï¼ŒleftæŒ‡é’ˆç§»åŠ¨å¯»æ‰¾æœ€å°çª—å£
3. æ›´æ–°ç­”æ¡ˆï¼šåœ¨æœ‰æ•ˆçª—å£ä¸­è®°å½•æœ€å°é•¿åº¦

å…³é”®æ•°æ®ç»“æ„ï¼š
- need: å­˜å‚¨tä¸­æ¯ä¸ªå­—ç¬¦çš„éœ€è¦æ•°é‡
- window: å­˜å‚¨å½“å‰çª—å£ä¸­æ¯ä¸ªå­—ç¬¦çš„æ•°é‡  
- valid: è®°å½•çª—å£ä¸­æ»¡è¶³é¢‘æ¬¡è¦æ±‚çš„å­—ç¬¦ç§ç±»æ•°

ç®—æ³•æµç¨‹ï¼š
```
1. åˆå§‹åŒ–needå“ˆå¸Œè¡¨ï¼Œç»Ÿè®¡tä¸­å­—ç¬¦é¢‘æ¬¡
2. ä½¿ç”¨left,rightåŒæŒ‡é’ˆç»´æŠ¤çª—å£[left,right)
3. å½“valid == need.size()æ—¶ï¼Œå½“å‰çª—å£è¦†ç›–äº†t
4. åœ¨æ»¡è¶³æ¡ä»¶çš„çª—å£ä¸­æ”¶ç¼©leftå¯»æ‰¾æœ€å°çª—å£
```

ä¸é¢˜ç›®3çš„åŒºåˆ«ï¼š
- é¢˜ç›®3: çª—å£å†…æ— é‡å¤å­—ç¬¦ (é™åˆ¶æ¡ä»¶)
- é¢˜ç›®76: çª—å£å†…è¦†ç›–ç›®æ ‡å­—ç¬¦ä¸² (æ»¡è¶³æ¡ä»¶)
- é¢˜ç›®3: æ±‚æœ€å¤§çª—å£
- é¢˜ç›®76: æ±‚æœ€å°çª—å£

å®ç°è¦ç‚¹ï¼š
1. validçš„æ›´æ–°æ—¶æœºï¼šå½“window[c] == need[c]æ—¶valid++
2. çª—å£æ”¶ç¼©æ¡ä»¶ï¼švalid == need.size()
3. æœ€å°çª—å£æ›´æ–°ï¼šåœ¨æ»¡è¶³æ¡ä»¶æ—¶æ›´æ–°ç­”æ¡ˆ
4. å­—ç¬¦é¢‘æ¬¡çš„æ­£ç¡®ç»´æŠ¤

è¿™æ˜¯æ»‘åŠ¨çª—å£çš„æœ€é«˜éš¾åº¦åº”ç”¨ï¼ŒæŒæ¡åå…¶ä»–æ»‘åŠ¨çª—å£é¢˜ç›®éƒ½ä¸æ˜¯é—®é¢˜ï¼
)" << endl;
}

// æ»‘åŠ¨çª—å£ç®—æ³•æ¡†æ¶å±•ç¤º
void showSlidingWindowFramework() {
    cout << "\nğŸ“– æ»‘åŠ¨çª—å£ç®—æ³•æ¡†æ¶" << endl;
    cout << "===================" << endl;
    cout << R"(
// åŸºäºä½ é¢˜ç›®3ç»éªŒçš„è¿›é˜¶æ¡†æ¶ï¼š
string slidingWindow(string s, string t) {
    unordered_map<char, int> need, window;
    for (char c : t) need[c]++;
    
    int left = 0, right = 0;
    int valid = 0;  // çª—å£ä¸­æ»¡è¶³needæ¡ä»¶çš„å­—ç¬¦ä¸ªæ•°
    
    // è®°å½•æœ€å°è¦†ç›–å­ä¸²çš„èµ·å§‹ç´¢å¼•åŠé•¿åº¦
    int start = 0, len = INT_MAX;
    
    while (right < s.size()) {
        char c = s[right];
        right++;
        
        // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
        if (need.count(c)) {
            window[c]++;
            if (window[c] == need[c])
                valid++;
        }
        
        // åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
        while (valid == need.size()) {
            // åœ¨è¿™é‡Œæ›´æ–°æœ€å°è¦†ç›–å­ä¸²
            if (right - left < len) {
                start = left;
                len = right - left;
            }
            
            char d = s[left];
            left++;
            
            // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
            if (need.count(d)) {
                if (window[d] == need[d])
                    valid--;
                window[d]--;
            }
        }
    }
    
    return len == INT_MAX ? "" : s.substr(start, len);
}
)" << endl;
}

int main() {
    cout << "ğŸš€ LeetCode 76. æœ€å°è¦†ç›–å­ä¸²" << endl;
    cout << "============================" << endl;
    cout << "ğŸ¯ åŸºäºä½ é¢˜ç›®3çš„æ»‘åŠ¨çª—å£åŸºç¡€ï¼Œè¿™æ˜¯æ»‘åŠ¨çª—å£çš„å·…å³°æŒ‘æˆ˜ï¼" << endl;
    cout << "ğŸ’¡ é‡ç‚¹ç†è§£å¤æ‚çº¦æŸæ¡ä»¶ä¸‹çš„çª—å£æ§åˆ¶æœºåˆ¶" << endl << endl;
    
    testSolution();
    showHints();
    showSlidingWindowFramework();
    
    return 0;
}

/*
ä¸“é¢˜å½’å±ï¼šå­—ç¬¦ä¸² + æ»‘åŠ¨çª—å£
éš¾åº¦è¯„ä¼°ï¼šâ­â­â­â­â­ (Hardéš¾åº¦ï¼Œæ»‘åŠ¨çª—å£çš„æœ€é«˜éš¾åº¦åº”ç”¨)
æŠ€èƒ½åŸºç¡€ï¼šåŸºäºä½ é¢˜ç›®3çš„æ»‘åŠ¨çª—å£ç»éªŒï¼Œè¿™æ˜¯å¤æ‚çº¦æŸæ¡ä»¶çš„é«˜çº§åº”ç”¨
æ ¸å¿ƒçªç ´ï¼šæŒæ¡validè®¡æ•°å™¨æŠ€å·§ï¼Œç†è§£çª—å£æ”¶ç¼©çš„æ—¶æœºæ§åˆ¶
*/